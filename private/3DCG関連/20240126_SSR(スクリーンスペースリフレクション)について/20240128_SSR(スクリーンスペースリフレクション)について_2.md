# SSR（スクリーンスペースリフレクション）について
## 必要な各ピクセルの情報
 - SSRは各ピクセルに対してレイを飛ばして反射を計算するのであらかじめバッファに情報を持っておく
 - 法線情報
   - 各ピクセルごとに物体の表面の法線ベクトルが必要
   - これにより、レイとの反射ベクトルを算出して反射先にレイをとばすことができる
 - 深度情報
   - 各ピクセルごとに視点からの深度情報が必要
   - これにより、反射先に飛ばしたレイが物体と衝突したかを判定できる
 - 表面の反射率情報
   - 各ピクセルごとに表面の反射率が必要
   - 反射光の計算に使用する

## 手順
### レイの方向
 - 各ピクセルはカメラの視点からレイの方向を決める
   - ピクセルのスクリーン座標を3D空間座標に変換する必要がある（ここで理解が躓いた）
   - ビュー変換行列やプロジェクション変換行列の逆行列を用いて更に深度情報を合わせて3D空間の座標を求める
   - 求めた3D空間座標とカメラの視点からレイの入射ベクトルを算出する
### 反射レイの生成
 - 先ほど求めたピクセルの3D空間座標を始点したレイを作る
 - 方向は法線ベクトルとレイの入射ベクトルから反射ベクトルを求める
### レイを進める
 - レイを少しずつ進める
 - レイをuv座標に変換して深度バッファの深度値と比較する
 - レイの深度値が深度バッファの深度値より奥ならuv座標のカラーを取得して反映

## 深度による衝突判定のデメリット
 - 深度値での比較では反射レイがオブジェクトを通過した場合にも衝突判定がとられてします。
 - 前回ほかの方法があるといいましたがSSRでは閾値を用いて誤差を低減させるのが一般的らしい。
