# ComPtrについて
## COMとは
 - Microsoftが提供するコンポーネントモデルの一つ
 - オブジェクトの公開方法やオブジェクト自身の寿命管理方法などを定義している
 - 統一したルールでコンポーネント化することで、異なるプロセスやネットワークであってもオブジェクト同士の機能を使用することができる
 - DirectX12で使うオブジェクトもCOMを用いて実装されている

## COMオブジェクトの作成＆削除
 - COMオブジェクトを作成するには`Microsoft::WRL::ComPtr`を用いる
   - COMオブジェクトを管理するスマートポインタで、ポインタ型に応じて適切な処理を行う機能を追加したクラス
 - 作成方法
   - DirectXでCOMオブジェクトを作成するにはC++の`new`やそのまま変数を宣言してもコンパイルエラーになる
   - それぞれ個別の生成メソッドを叩く必要がある
   - 例
     - `ID3D12Device`の場合`ID3D12CreateDevice関数`を使って作成
 - 削除方法
   - `Release関数`を使って解放
   - 参照カウンタが０になると自動で解放されるためプログラマが明示的に`Release関数`を呼ばなくてもよい


